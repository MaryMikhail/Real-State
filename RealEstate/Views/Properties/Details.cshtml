@model RealEstate.Models.Property

@{
    ViewData["Title"] = "Details";
    List<Image> AllImages = ViewBag.AllImages;
    int CountReviews = @ViewBag.countReviews;
    if (CountReviews >= 5)
        CountReviews = 5;
}

<div class="row">
        <div class="col-lg-10 container">

            <div id="carouselExampleControls" class="carousel slide" data-ride="carousel">
                <div class="carousel-inner" style="margin-left:13%">
                    @if (@ViewBag.NumImages != null)
                    {
                        @for (int i = 0; i < @ViewBag.NumImages; i++)
                        {
                            if (i == 0)
                            {
                                <div class="carousel-item active">
                                    <img class="d-block w-75 img-fluid img-thumbnail" src="~/images/property/@ViewBag.Images[i].ImgData" alt="@ViewBag.Images[i].ImgData">
                                </div>
                            }
                            else
                            {
                                <div class="carousel-item">
                                    <img class="d-block w-75 img-fluid img-thumbnail" src="~/images/property/@ViewBag.Images[i].ImgData" alt="@ViewBag.Images[i].ImgData">
                                </div>
                            }
                        }
                    }
                </div>
                <a class="carousel-control-prev text-danger" href="#carouselExampleControls" role="button" data-slide="prev">
                    <span class="carousel-control-prev-icon text-danger" aria-hidden="true"></span>
                    <span class="sr-only text-danger">Previous</span>
                </a>
                <a class="carousel-control-next text-danger" href="#carouselExampleControls" role="button" data-slide="next">
                    <span class="carousel-control-next-icon text-danger" aria-hidden="true"></span>
                    <span class="sr-only text-danger">Next</span>
                </a>
            </div>
        </div>
    </div>
</div>



<section class="p0">
    <div class="container">
        <div class="row listing_single_row style2">
            <div class="col-lg-7 col-xl-8">
                <div class="single_property_title multicolor_style mt30-767">
                    <h2>@Html.DisplayFor(model => model.Title)</h2>
                    <p>@Html.DisplayFor(model => model.Address)</p>
                </div>
            </div>
            <div class="col-lg-5 col-xl-4">
                <div class="single_property_social_share multicolor_style text-right tal-767">
                    <div class="price">
                        <h2>@Html.DisplayFor(model => model.Price)</h2>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
<section class="sticky_heading h60 p0">
    <div class="container">
        <div class="row">
            <div class="col-xl-12">
                <div class="sticky-nav-tabs">
                    <ul class="sticky-nav-tabs-container">
                        <li class="list-inline-item nav-item active"><a class="sticky-nav-tab" href="#tab-1">Details</a></li>

                        <li class="list-inline-item nav-item"><a class="sticky-nav-tab" href="#tab-6">Reviews</a></li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Listing Single V5 Area -->
<section class="our-listing-single bgc-f7 pb30-991">
    <div class="container">
        <div class="row">
            <div class="col-md-12 col-lg-8 mt35">
                <div class="row">
                    <div id="tab-1" class="col-lg-12">
                        <div class="listing_single_description">
                            <div class="lsd_list">
                                <ul class="mb0">
                                    <li class="list-inline-item"><a href="#">@Html.DisplayFor(model => model.PropertyType)</a></li>
                                    <li class="list-inline-item"><a href="#">Beds: @Html.DisplayFor(model => model.Rooms)</a></li>
                                    <li class="list-inline-item"><a href="#">Baths: @Html.DisplayFor(model => model.Bathrooms)</a></li>
                                    <li class="list-inline-item"><a href="#">Sq Ft: @Html.DisplayFor(model => model.AreaSize)</a></li>
                                </ul>
                            </div>
                            <h4 class="mb30">Description</h4>
                            <p class="mb25">@Html.DisplayFor(model => model.Description)</p>
                            <p class="overlay_close">
                                <a class="text-thm fz14" data-toggle="collapse" href="#collapseExample" role="button" aria-expanded="false" aria-controls="collapseExample">
                                    Show More <span class="flaticon-download-1 fz12"></span>
                                </a>
                            </p>
                        </div>
                    </div>
                    <div class="col-lg-12">
                        <div class="additional_details">
                            <div class="row">
                                <div class="col-lg-12">
                                    <h4 class="mb15">Property Details</h4>
                                </div>
                                <div class="col-md-6 col-lg-6 col-xl-4">
                                    <ul class="list-inline-item">
                                        <li><p>Property ID : <span>@Html.DisplayFor(model => model.PropertyID)</span></p></li>
                                        <li><p>Price : <span>$ @Html.DisplayFor(model => model.Price)</span></p></li>
                                        <li><p>Property Size : <span>@Html.DisplayFor(model => model.AreaSize) Sq Ft</span></p></li>
                                        <li><p>Year Built : <span>@Html.DisplayFor(model => model.YearBuilt.Year)</span></p></li>
                                    </ul>
                                </div>
                                <div class="col-md-6 col-lg-6 col-xl-4">
                                    <ul class="list-inline-item">
                                        <li><p>Bedrooms :</p></li>
                                        <li><p>Bathrooms :</p></li>
                                    </ul>
                                    <ul class="list-inline-item">
                                        <li><p><span>@Html.DisplayFor(model => model.Rooms)</span></p></li>
                                        <li><p><span>@Html.DisplayFor(model => model.Bathrooms)</span></p></li>
                                    </ul>
                                </div>
                                <div class="col-md-6 col-lg-6 col-xl-4">
                                    <ul class="list-inline-item">
                                        <li><p>Property Type :</p></li>
                                        <li><p>Property Status :</p></li>
                                    </ul>
                                    <ul class="list-inline-item">
                                        <li><p><span>@Html.DisplayFor(model => model.PropertyType)</span></p></li>
                                        <li><p><span>@Html.DisplayFor(model => model.PropertyStatus)</span></p></li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-12">
                        <div id="tab-3" class="application_statics mt30">
                            <h3 class="mb30 text-center font-weight-bold text-black"> Location </h3>
                            <h4 class="mb30 font-weight-bold text-danger">Address :  <span class="float-right font-weight-bold text-info">@Html.DisplayFor(model => model.Address) </span> </h4>
                            <h4 class="mb30 font-weight-bold text-danger">Country : <span class="float-right font-weight-bold text-info">@Html.DisplayFor(model => model.Country) </span></h4>
                            <h4 class="mb30 font-weight-bold text-danger">City : <span class="float-right font-weight-bold text-info">@Html.DisplayFor(model => model.City) </span></h4>
                        </div>
                    </div>
                    <div class="col-lg-12">
                        <div id="tab-6" class="product_single_content">
                            <div class="mbp_pagination_comments mt30">
                                @if (@ViewBag.NumOfReview != null)
                                {
                                    <ul class="total_reivew_view">
                                        <li class="list-inline-item sub_titles"><span class="text-danger">@ViewBag.NumOfReview</span>  Reviews</li>
                                        <li class="list-inline-item">
                                            <ul class="star_list">
                                                @for (int i = 0; i < @ViewBag.RateOfProp; i++)
                                                {
                                                    <li class="list-inline-item"><a href="#"><i class="fa fa-star" style="color:limegreen"></i></a></li>
                                                }
                                                @for (int i = 0; i < 5 - @ViewBag.RateOfProp; i++)
                                                {
                                                    <li class="list-inline-item"><a href="#"><i class="fa fa-star" style="color:darkgray"></i></a></li>
                                                }
                                            </ul>
                                        </li>
                                        <li class="list-inline-item avrg_review text-danger" style="font-weight:bold">( @ViewBag.RateOfProp out of 5 )</li> <!-- Total Rate -->
                                    </ul>
                                }
                                @if (@ViewBag.countReviews != null)
                                {
                            <div class="mbp_first media" style="display: inline-block;">
                                @for (int i = 0; i < CountReviews; i++)
                                {
                                    var user = await UserManager.FindByIdAsync(@ViewBag.Reviews[i].UserID);
                                    var gender = user.gender;
                                    var mail = user.Email.Split("@");
                                    var name = mail[0];
                                    
                                    if (gender == Gender.Male)
                                    {
                                        <img src="~/images/team/Male.jpg" class="mr-3 rounded-circle" alt="Male Jpg" style="width: 50px; height:50px ; margin-bottom: 22%">
                                    }
                                    else if (gender == Gender.Female)
                                    {
                                        <img src="~/images/team/Female.jpg" alt="Female Jpg" class="mr-3 rounded-circle"  style="width: 50px; height:50px ; margin-bottom: 22%">
                                    }
                                    <div class="media-body" style="display: inline-block;">
                                        <h4 class="sub_title mt-0">

                                            @name
                                            <div class="sspd_review dif">
                                                <ul class="ml10">
                                                    @for (int j = 0; j < @ViewBag.Reviews[i].PropertyRate; j++)
                                                    {
                                                        <li class="list-inline-item"><a href="#"><i class="fa fa-star" style="color:limegreen"></i></a></li>
                                                    }
                                                    @for (int k = 0; k < 5 - @ViewBag.Reviews[i].PropertyRate; k++)
                                                    {
                                                        <li class="list-inline-item"><a href="#"><i class="fa fa-star" style="color:darkgray"></i></a></li>
                                                    }
                                                </ul>
                                            </div>
                                        </h4>
                                        <a class="sspd_postdate fz14" href="#">@ViewBag.Reviews[i].Date</a>
                                        <p class="mt10">@ViewBag.Reviews[i].Body</p>
                                    </div>
                                    <div style="margin-top:2%"></div>
                                }

                                <a class="btn btn-success" style="display:none;cursor:pointer" asp-action="LoadAllReviews" asp-controller="Properties" asp-route-id="@Model.PropertyID">
                                    Load All Reviews
                                </a>
                                @if (@ViewBag.countReviews > 5)
                                {
                                    <a class="btn btn-success" style="display:block;cursor:pointer" asp-action="LoadAllReviews" asp-controller="Properties" asp-route-id="@Model.PropertyID">
                                        Load All Reviews
                                    </a>
                                }
                            </div>
                                }
                                <div class="custom_hr"></div>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-12 container">
                        <div class="product_single_content">
                            <div class="mbp_pagination_comments mt30">
                                <div class="mbp_comment_form style2" style="margin-left:37%">
                                    <h4>Write a Review</h4>
                                    <form>
                                        <button type="submit" class="btn btn-thm" asp-action="CreateReview" asp-route-id="@Model.PropertyID">Submit Review <span class="flaticon-right-arrow-1"></span></button>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>

    </div>
    @* End Of Container *@

    <!-- Listing Grid View -->
    <section class="our-listing bgc-f7 pb30-991">
        <div class="container">
            <div class="row">

                <div class="col-md-12 col-lg-12">
                    <div class="row">
                        @if (@ViewBag.SimilarPropertiesCount != null)
                        {
                            <div class="col-lg-12">
                                <h4 class="mt30 mb30">Similar Properties</h4>
                            </div>
                            foreach (var property in @ViewBag.SimilarProperties)
                            {
                                <div class="feat_property col-lg-4">
                                    <div class="thumb">
                                        @{
                                            var FirstImg = AllImages.FirstOrDefault(c => c.PropertyID == @property.PropertyID);
                                            {
                                                <img class="img-whp" src="~/images/property/@FirstImg.ImgData" alt="@FirstImg.ImgData">
                                            }
                                        }
                                        <div class="thmb_cntnt">
                                            <ul class="tag mb0">
                                                <li class="list-inline-item"><a asp-action="Details" asp-controller="Properties" asp-route-id="@property.PropertyID">@property.PropertyStatus</a></li>
                                            </ul>
                                            <ul class="icon mb0">
                                                <li class="list-inline-item"><a href="#"><span class="flaticon-transfer-1"></span></a></li>
                                                <li class="list-inline-item"><a href="#"><span class="flaticon-heart"></span></a></li>
                                            </ul>
                                            <a class="fp_price" href="#">@property.Price</a>
                                        </div>
                                    </div>
                                    <div class="details">
                                        <div class="tc_content">
                                            <p class="text-thm">@property.PropertyType</p>
                                            <h4>@property.Title</h4>
                                            <p><span class="flaticon-placeholder"></span> @property.Address</p>
                                            <ul class="prop_details mb0">
                                                <li class="list-inline-item"><a href="#">Beds: @property.Rooms</a></li>
                                                <li class="list-inline-item"><a href="#">Baths: @property.Bathrooms</a></li>
                                                <li class="list-inline-item"><a href="#">Sq Ft: @property.AreaSize</a></li>
                                            </ul>
                                        </div>
                                        <div class="fp_footer">
                                            @{ 
                                                var user = await UserManager.FindByIdAsync(@property.UserID);
                                                var gender = user.gender;
                                                var mail = user.Email.Split("@");
                                                var name = mail[0];
                                            }
                                            
                                            <ul class="fp_meta float-left mb0">
                                                @if (gender == Gender.Male)
                                                {
                                                    <li class="list-inline-item"><a href="#"><img src="~/images/team/Male.jpg" alt="Male Jpg" style="width: 50px; height:50px" class="rounded-circle"></a></li>
                                                }
                                                else if (gender == Gender.Female)
                                                {
                                                    <li class="list-inline-item"><a href="#"><img src="~/images/team/Female.jpg" alt="Female Jpg" style="width: 50px; height:50px" class="rounded-circle"></a></li>
                                                }
                                                <li class="list-inline-item"><a href="#">@name</a></li>
                                            </ul>
                                            <div class="fp_pdate float-right">@property.YearBuilt</div>
                                        </div>
                                    </div>
                                </div>
                            }
                        }
                    </div>
                </div>

            </div>
        </div>
    </section>


    <div style="margin-left: 12%">
        <a asp-action="Edit" asp-route-id="@Model.PropertyID" class="btn btn-success">Edit</a>
        <a asp-action="Index" class="btn btn-primary">Back to List</a>
    </div>
</section>

<a class="scrollToHome" href="#"><i class="flaticon-arrows"></i></a>

